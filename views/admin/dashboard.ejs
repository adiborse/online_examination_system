<%- include('../partials/header') %>

<div class="container admin-dashboard">
    <h1>Admin Dashboard</h1>
    
    <div class="stats-grid">
        <div class="stat-card">
            <span class="stat-number"><%= stats.totalQuestions %></span>
            <div class="stat-label">Total Questions</div>
        </div>
        <div class="stat-card">
            <span class="stat-number"><%= stats.totalStudents %></span>
            <div class="stat-label">Total Students</div>
        </div>
        <div class="stat-card">
            <span class="stat-number"><%= stats.totalExams %></span>
            <div class="stat-label">Exams Taken</div>
        </div>
    </div>
    
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem;">
        <div class="card">
            <div class="card-header">
                Quick Actions
            </div>
            <div class="card-body">
                <div style="display: flex; flex-direction: column; gap: 1rem;">
                    <a href="/admin/questions" class="btn btn-primary">Manage Questions</a>
                    <a href="/admin/results" class="btn btn-secondary">View Results</a>
                    <button id="addQuestionBtn" class="btn btn-success">Add New Question</button>
                </div>
            </div>
        </div>
        
        <div class="card">
            <div class="card-header">
                Recent Exam Results
            </div>
            <div class="card-body">
                <% if (recentResults.length > 0) { %>
                    <div class="table-container">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Student</th>
                                    <th>Score</th>
                                    <th>Date</th>
                                </tr>
                            </thead>
                            <tbody>
                                <% recentResults.forEach(result => { %>
                                    <tr>
                                        <td><%= result.userId.name %></td>
                                        <td><%= result.percentage %>%</td>
                                        <td><%= result.createdAt.toLocaleDateString() %></td>
                                    </tr>
                                <% }) %>
                            </tbody>
                        </table>
                    </div>
                    <div class="text-center">
                        <a href="/admin/results" class="btn btn-secondary btn-sm">View All Results</a>
                    </div>
                <% } else { %>
                    <p class="text-center" style="color: #666;">No exam results yet</p>
                <% } %>
            </div>
        </div>
    </div>
</div>

<!-- Question Modal -->
<div id="questionModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="modalTitle">Add New Question</h3>
            <span class="close">&times;</span>
        </div>
        <form id="questionForm">
            <div class="form-group">
                <label for="question" class="form-label">Question Text *</label>
                <textarea id="question" name="question" class="form-control" rows="3" required></textarea>
            </div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                <div class="form-group">
                    <label for="option1" class="form-label">Option 1 *</label>
                    <input type="text" id="option1" name="option1" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="option2" class="form-label">Option 2 *</label>
                    <input type="text" id="option2" name="option2" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="option3" class="form-label">Option 3 *</label>
                    <input type="text" id="option3" name="option3" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="option4" class="form-label">Option 4 *</label>
                    <input type="text" id="option4" name="option4" class="form-control" required>
                </div>
            </div>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                <div class="form-group">
                    <label for="correctAnswer" class="form-label">Correct Answer (0-3) *</label>
                    <select id="correctAnswer" name="correctAnswer" class="form-control" required>
                        <option value="">Select correct option</option>
                        <option value="0">Option 1</option>
                        <option value="1">Option 2</option>
                        <option value="2">Option 3</option>
                        <option value="3">Option 4</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="difficulty" class="form-label">Difficulty</label>
                    <select id="difficulty" name="difficulty" class="form-control">
                        <option value="easy">Easy</option>
                        <option value="medium" selected>Medium</option>
                        <option value="hard">Hard</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="subject" class="form-label">Subject *</label>
                    <input type="text" id="subject" name="subject" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="category" class="form-label">Category</label>
                    <input type="text" id="category" name="category" class="form-control">
                </div>
            </div>
            
            <div class="d-flex gap-1 justify-content-between mt-2">
                <button type="button" id="cancelBtn" class="btn btn-secondary">Cancel</button>
                <button type="submit" class="btn btn-primary">Save Question</button>
            </div>
        </form>
    </div>
</div>

<%- include('../partials/footer') %>
